{% extends "employees/base.html" %}
{% block content %}

<h2>Employees</h2>

<input id="emp_id" placeholder="Employee ID">
<input id="name" placeholder="Full Name">
<input id="email" placeholder="Email">
<input id="dept" placeholder="Department">
<button onclick="addEmployee()">Add</button>

<table id="empTable">
    <tr>
        <th>Name</th><th>Email</th><th>Dept</th><th>Action</th>
    </tr>
</table>

<script>
function loadEmployees() {
    fetch("/api/employees/")
        .then(res => res.json())
        .then(data => {
            const table = document.getElementById("empTable");
            data.forEach(e => {
                table.innerHTML += `
                    <tr>
                        <td>${e.full_name}</td>
                        <td>${e.email}</td>
                        <td>${e.department}</td>
                        <td><button onclick="del(${e.id})">Delete</button></td>
                    </tr>
                `;
            });
        });
}

function addEmployee() {
    fetch("/api/employees/", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            employee_id: emp_id.value,
            full_name: name.value,
            email: email.value,
            department: dept.value
        })
    }).then(() => location.reload());
}

function del(id) {
    fetch(`/api/employees/${id}/`, {method: "DELETE"})
        .then(() => location.reload());
}

loadEmployees();
</script>

{% endblock %}
